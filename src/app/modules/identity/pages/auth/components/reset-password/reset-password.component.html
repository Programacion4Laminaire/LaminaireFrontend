<div class="flex min-h-screen w-full">
  <div class="w-full md:w-1/2 flex items-center justify-center bg-[#f9fafc]">
    <div
      class="w-full max-w-md px-6 py-8 bg-white rounded-xl shadow-lg
             flex flex-col h-auto"
    >
      <!-- Header -->
      <div class="text-center mb-6">
        <img src="public/logo-SIR.png" class="mx-auto w-40 mb-2" />
        <p class="text-gray-600 mt-2">Restablece tu contraseña</p>
      </div>

      <!-- Form: flex-col para que todo fluya verticalmente -->
     <form [formGroup]="form" (ngSubmit)="resetPassword()" class="space-y-2">
  <!-- Identificación -->
  <div
    class="field-wrapper"
    [class.error]="
      form.get('identification')!.invalid &&
      form.get('identification')!.touched
    "
  >
    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Identificación</mat-label>
      <input matInput formControlName="identification" placeholder="Documento" />
      <mat-error *ngIf="form.get('identification')!.hasError('required')">
        Campo requerido.
      </mat-error>
    </mat-form-field>
  </div>

  <!-- Usuario -->
  <div
    class="field-wrapper"
    [class.error]="
      form.get('userName')!.invalid &&
      form.get('userName')!.touched
    "
  >
    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Usuario</mat-label>
      <input matInput formControlName="userName" placeholder="Usuario" />
      <mat-error *ngIf="form.get('userName')!.hasError('required')">
        Campo requerido.
      </mat-error>
    </mat-form-field>
  </div>

  <!-- Fecha de nacimiento -->
  <div
    class="field-wrapper"
    [class.error]="
      form.get('birthDate')!.invalid &&
      form.get('birthDate')!.touched
    "
  >
    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Fecha de Nacimiento</mat-label>
      <input matInput type="date" formControlName="birthDate" />
      <mat-error *ngIf="form.get('birthDate')!.hasError('required')">
        Campo requerido.
      </mat-error>
    </mat-form-field>
  </div>

  <!-- Nueva contraseña -->
  <div
    class="field-wrapper"
    [class.error]="
      form.get('newPassword')!.invalid && form.get('newPassword')!.touched
    "
  >
    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Nueva Contraseña</mat-label>
      <input
        [type]="inputType"
        matInput
        formControlName="newPassword"
        placeholder="********"
      />
      <button
        type="button"
        mat-icon-button
        matSuffix
        (click)="toggleVisibility()"
        matTooltip="{{ visible ? 'Ocultar' : 'Ver' }}"
      >
        <mat-icon *ngIf="visible" [fontIcon]="icVis"></mat-icon>
        <mat-icon *ngIf="!visible" [fontIcon]="icVisOff"></mat-icon>
      </button>
      <mat-error *ngIf="form.get('newPassword')!.hasError('required')">
        Campo requerido.
      </mat-error>
      <mat-error *ngIf="form.get('newPassword')!.hasError('minlength')">
        Mínimo 8 caracteres.
      </mat-error>
      <mat-error *ngIf="form.get('newPassword')!.hasError('pattern')">
        Debe tener mayúscula, minúscula, número y carácter especial.
      </mat-error>
    </mat-form-field>
  </div>

  <!-- Confirmar contraseña -->
  <div
    class="field-wrapper"
    [class.error]="form.hasError('mismatch') && form.get('confirmPassword')!.touched"
  >
    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Confirmar Contraseña</mat-label>
      <input
        [type]="inputType"
        matInput
        formControlName="confirmPassword"
        placeholder="********"
      />
      <button
        type="button"
        mat-icon-button
        matSuffix
        (click)="toggleVisibility()"
        matTooltip="{{ visible ? 'Ocultar' : 'Ver' }}"
      >
        <mat-icon *ngIf="visible" [fontIcon]="icVis"></mat-icon>
        <mat-icon *ngIf="!visible" [fontIcon]="icVisOff"></mat-icon>
      </button>
      <mat-error *ngIf="form.hasError('mismatch')">
        Las contraseñas no coinciden.
      </mat-error>
    </mat-form-field>
  </div>

  <button
    type="submit"
    class="w-full rounded-xl h-11 font-medium text-white bg-am-main-blue-dark hover:bg-am-main-blue transition duration-300"
    [disabled]="form.invalid || form.hasError('mismatch')"
  >
    Restablecer Contraseña
  </button>

  <app-spinner />
</form>


      <!-- Footer -->
      <p class="text-center mt-4">
        <a [routerLink]="['/login']" class="text-am-main-blue-dark hover:underline">
          Volver al inicio de sesión
        </a>
      </p>
    </div>
  </div>

  <!-- Columna derecha igual -->
  <div class="hidden md:flex w-1/2 relative bg-[#0e0e52] text-white">
    <img src="public/fondosir.png" class="object-cover w-full h-full" />
    <div
      class="absolute bottom-0 w-full px-10 pb-10 text-center
             bg-gradient-to-t from-[#0e0e52]/80 via-transparent to-transparent z-10"
    >
      <p class="text-lg italic">“SIR Enterprise está diseñado para el presente, preparado para el futuro e inspirado en nuestra gente.”</p>
      <p class="mt-4 font-semibold text-base">Compromiso con la Excelencia</p>
      <p class="text-sm">Tecnología al servicio del talento Laminaire</p>
    </div>
  </div>
</div>
